Fix threading race condition where the wrong allocation would be deleted if a memory address was reused.