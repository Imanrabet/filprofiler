Fix a number of potential deadlock scenarios when writing out reports.